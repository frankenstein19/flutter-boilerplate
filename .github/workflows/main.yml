name: CI
on:
  pull_request:
  push:
  name: "Build and Release"
  jobs:
    build:
      name: Build and Release
      runs-on: macos-latest
      steps:
        - uses: action/checkout@v1

        - uses: action/setup-java@v1
          with:
            channel: 'stable'

        - uses: subosito/flutter-action@v1
          with:
            channel: 'stable'

        - run: flutter pub get

        - run: flutter pub run build_runner build

        - run: flutter test

        - run: flutter build apk

        - name: Push to Release
          uses: ncipollo/release-action@v1
          with:
            artifacts: "build/app/outputs/apk/*"
            tag: v1.0.${{github.run_number}}
